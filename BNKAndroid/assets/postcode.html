<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>우편번호 찾기</title>
    <style>
        html, body, #wrap { height: 100%; margin: 0; }
        body { overscroll-behavior: contain; }
    </style>
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
</head>
<body>
<div id="wrap"></div>
<script>
    function sendToFlutter(payload){
      // 1) 모바일(WebView) 경로: webview_flutter JS 채널
      if (window.App && window.App.postMessage) {
        window.App.postMessage(JSON.stringify(payload));
        return;
      }
      // 2) 웹(Chrome) 경로: 부모(Flutter Web) 창으로 전달
      if (window.parent) {
        window.parent.postMessage({ type: 'postcode', payload }, '*');
      }
    }

    new daum.Postcode({
      oncomplete: function (data) {
        const extra = [data.bname, data.buildingName].filter(Boolean).join(' ');
        sendToFlutter({
          zonecode: data.zonecode,
          roadAddress: data.roadAddress,
          jibunAddress: data.jibunAddress,
          extraAddress: extra
        });
      },
      width:'100%', height:'100%'
    }).embed(document.getElementById('wrap'));
</script>
</body>
</html>
